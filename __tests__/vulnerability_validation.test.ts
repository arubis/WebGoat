

describe('security', () => {
it('security_sql_injection_approach_1', () => {
  // Attack vector: sql_injection
    import { describe, it, expect } from 'vitest';
  import fs from 'fs';
  import path from 'path';

  describe('SQL Injection Prevention - Pattern Matching', () => {
    it('should not use string concatenation with user input in query construction', () => {
      const sourceFile = path.join(process.cwd(), 'src/main/resources/webgoat/static/js/goatApp/support/CustomGoat.js');
      const sourceCode = fs.readFileSync(sourceFile, 'utf8');
      
      const dangerousPattern = /['"][\s\S]*\+[\s\S]*\.value\(\)/;
      
      expect(sourceCode).not.toMatch(dangerousPattern);
    });
  });
});

});
